<div class="px-6 mt-8 mb-4">
	<app-page-title title="New quote"></app-page-title>
</div>

<!-- Calculation Form -->
<app-calculator-form
	#calculatorForm
	(quoteCalculated)="onQuoteCalculated($event)"
></app-calculator-form>

<!-- Calculation Output -->
<ng-container *ngIf="quote$ | async as quote">
	<div class="px-6 mt-8 mb-4">
		<h2 class="text-2xl font-bold">Breakdown</h2>
	</div>

	<div
		class="flex flex-col mb-16 bg-white border rounded-lg shadow-sm shadow-slate-300/50"
	>
		<div class="flex items-center justify-between w-full px-6 py-4 border-b">
			<h2 class="text-lg font-semibold">Estimate</h2>

			<ng-container *ngIf="isLoggedIn$ | async">
				<button
					class="flex items-center h-8 gap-2 px-2 text-sm font-semibold transition-colors rounded-l text-emerald-600 hover:bg-emerald-50/75"
					type="button"
					(click)="calculatorForm.saveQuote()"
				>
					<ng-container *ngIf="currentQuote$ | async; else saveQuoteIcon">
						<svg viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
							<path
								fill-rule="evenodd"
								d="M6.32 2.577a49.255 49.255 0 0111.36 0c1.497.174 2.57 1.46 2.57 2.93V21a.75.75 0 01-1.085.67L12 18.089l-7.165 3.583A.75.75 0 013.75 21V5.507c0-1.47 1.073-2.756 2.57-2.93z"
								clip-rule="evenodd"
							/>
						</svg>

						Quote saved
					</ng-container>

					<ng-template #saveQuoteIcon>
						<svg
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="1.5"
							stroke="currentColor"
							class="w-6 h-6"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"
							/>
						</svg>

						Save this quote
					</ng-template>
				</button>
			</ng-container>
		</div>

		<div class="flex flex-col px-6 py-4">
			<div class="text-2xl">{{ quote | currency : 'GBP' }}</div>
		</div>

		<div class="flex items-center justify-between w-full px-6 py-4 border-y">
			<h2 class="text-lg font-semibold">Details</h2>
		</div>

		<div class="flex flex-col px-6 py-4">
			<span>Hi</span>
		</div>
	</div>
</ng-container>

<!-- "Sign in to save quote" -->
<ng-container *ngIf="!(isLoggedIn$ | async)">
	<app-user-notice></app-user-notice>
</ng-container>
